##############################################################
###    General                                             ###
##############################################################
# general settings
cmake_minimum_required (VERSION 2.8.11) # ???
project (H2Lib)

# The version number.
set(H2LIB_VERSION_MAJOR 1)
set(H2LIB_VERSION_MINOR 0)


##############################################################
###    Set Compiler Flags                                  ###
##############################################################
# Find Libraries
find_package (BLAS)
find_package (LAPACK)
if (BLAS_FOUND AND LAPACK_FOUND)
  set(CMAKE_C_FLAGS "-DUSEBLAS ${CMAKE_C_FLAGS}")
endif (BLAS_FOUND AND LAPACK_FOUND)


# Compiler flags
set(CMAKE_C_COMPILER gcc)
set(CMAKE_C_FLAGS "-O3 -Wall -march=ivybridge -funroll-loops -funswitch-loops ${CMAKE_C_FLAGS}")
set(CMAKE_C_FLAGS_DEBUG "-g -Wall ${CMAKE_C_FLAGS_DEBUG}")
set(CMAKE_C_FLAGS_RELEASE "-O3 -Wall ${CMAKE_C_FLAGS_RELEASE}")

# Options
option(USE_OPENMP "Compile with openmp" ON)
find_package(OpenMP)
if (USE_OPENMP AND OPENMP_FOUND)
  set (CMAKE_C_FLAGS "${CMAKE_C_FLAGS} ${OpenMP_C_FLAGS}")
  add_definitions(-DUSE_OPENMP)
endif ()

option(USE_SIMD "Compile with SIMD" OFF)
if (USE_SIMD)
  add_definitions(-DUSE_SIMD)
endif ()

##############################################################
###    Subdirectories                                      ###
##############################################################
add_subdirectory (Library)
add_subdirectory (Tests)


##############################################################
###    Include Directories                                 ###
##############################################################
include_directories( ${PROJECT_SOURCE_DIR}/Library )

